<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/styles/styles.css">
  <title>Supermarket App</title>
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar">
    <a href="/" class="brand">ShopFood</a>
    <ul class="nav-links">
      <li><a href="/cart">View Cart</a></li>
      <li><a href="/logout">Logout</a></li>
    </ul>
  </nav>


  <div class="container">
    <p class="welcome-text">Welcome, <%= user.username %> (<%= user.role %>)</p>
    <h2 class="page-title">Shop Products</h2>

    <table class="styled-table">
      <thead>
        <tr>
          <th>Product Name</th>
          <th>Product Image</th>
          <th>Quantity Available</th>
          <th>Price</th>
          <th>Select Qty</th>
          <th>Buy</th>
        </tr>
      </thead>
      <tbody>
        <% for (let i=0; i < products.length; i++) { %>
          <tr>
            <td>
              <a href="/product/<%= products[i].productId %>">
                <%= products[i].productName %>
              </a>
            </td>
            <td>
              <img src="/images/<%= products[i].image %>" alt="<%= products[i].productName %>" class="product-img">
            </td>
            <td>
              <%= products[i].quantity %>
            </td>
            <td>$<%= products[i].price.toFixed(2) %>
            </td>
            <td>
              <select class="quantity-dropdown"
                onchange="document.getElementById('quantity-<%= products[i].productId %>').value = this.value">
                <% for (let q=1; q <=5; q++) { %>
                  <option value="<%= q %>">
                    <%= q %>
                  </option>
                  <% } %>
              </select>
            </td>
            <td>
              <form action="/add-to-cart/<%= products[i].productId %>" method="POST">
                <input type="hidden" name="quantity" id="quantity-<%= products[i].productId %>" value="1">
                <button type="submit" class="btn-purchase">Buy</button>
              </form>
            </td>
          </tr>
          <% } %>
      </tbody>
    </table>
  </div>
</body>

</html>